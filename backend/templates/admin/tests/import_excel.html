{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
&rsaquo; <a href="{% url 'admin:tests_test_changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
&rsaquo; {% trans 'Import Excel' %}
</div>
{% endblock %}

{% block content %}
<h1>Excel orqali test import qilish</h1>

<div style="margin: 20px 0; padding: 15px; background: #f0f0f0; border-radius: 5px;">
  <h3>Excel fayl formati:</h3>
  <p><strong>Qator 1:</strong> Test nomi (A1: "Test nomi", B1: "Python Developer Test")</p>
  <p><strong>Qator 2:</strong> Tavsif (A2: "Tavsif", B2: "Python dasturlash bo'yicha test")</p>
  <p><strong>Qator 3:</strong> Lavozim (A3: "Lavozim", B3: "Python Developer")</p>
  <p><strong>Qator 4:</strong> Vaqt chegarasi (A4: "Vaqt", B4: 60) - daqiqalarda</p>
  <p><strong>Qator 5:</strong> O'tish balli (A5: "O'tish balli", B5: 60) - foizda</p>
  <p><strong>Qator 6:</strong> Bo'sh qator</p>
  <p><strong>Qator 7 va undan keyin:</strong> Savollar</p>
  <ul>
    <li><strong>A ustuni:</strong> Savol matni</li>
    <li><strong>B ustuni:</strong> 1-variant</li>
    <li><strong>C ustuni:</strong> 2-variant</li>
    <li><strong>D ustuni:</strong> 3-variant</li>
    <li><strong>E ustuni:</strong> 4-variant</li>
    <li><strong>F ustuni:</strong> To'g'ri javob (1, 2, 3 yoki 4)</li>
  </ul>
</div>

<form method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <fieldset class="module aligned">
    <div class="form-row">
      <div>
        <label for="{{ form.excel_file.id_for_label }}">{{ form.excel_file.label }}:</label>
        {{ form.excel_file }}
        {% if form.excel_file.help_text %}
          <p class="help">{{ form.excel_file.help_text }}</p>
        {% endif %}
        {% if form.excel_file.errors %}
          <ul class="errorlist">
            {% for error in form.excel_file.errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
    </div>
  </fieldset>
  
  <div class="submit-row">
    <a href="?download_template=1" class="button" style="background: #417690; color: white; padding: 10px 15px; text-decoration: none; border-radius: 4px; margin-right: 10px;">
      ðŸ“¥ Example Template yuklab olish
    </a>
    <input type="submit" value="Import qilish" class="default" />
    <a href="{% url 'admin:tests_test_changelist' %}" class="button">Bekor qilish</a>
  </div>
</form>
{% endblock %}

